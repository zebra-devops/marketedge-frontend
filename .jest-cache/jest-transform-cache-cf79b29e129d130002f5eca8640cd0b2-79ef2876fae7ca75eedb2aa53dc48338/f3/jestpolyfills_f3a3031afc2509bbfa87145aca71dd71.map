{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/jest.polyfills.js"],"sourcesContent":["// Jest polyfills for browser APIs\n\n// TextEncoder/TextDecoder polyfill for Node.js\nconst { TextEncoder, TextDecoder } = require('util')\nglobal.TextEncoder = TextEncoder\nglobal.TextDecoder = TextDecoder\n\n// Fetch polyfill\nrequire('whatwg-fetch')\n\n// URL polyfill\nconst { URL, URLSearchParams } = require('url')\nglobal.URL = URL\nglobal.URLSearchParams = URLSearchParams\n\n// Web Streams polyfill\ntry {\n  const { ReadableStream, WritableStream, TransformStream } = require('node:stream/web')\n  if (!global.ReadableStream) global.ReadableStream = ReadableStream\n  if (!global.WritableStream) global.WritableStream = WritableStream\n  if (!global.TransformStream) global.TransformStream = TransformStream\n} catch (e) {\n  // Fallback for older Node versions - provide minimal implementations\n  console.warn('Web streams not available, using minimal polyfills')\n  if (!global.ReadableStream) {\n    global.ReadableStream = class ReadableStream {}\n  }\n  if (!global.TransformStream) {\n    global.TransformStream = class TransformStream {}\n  }\n}\n\n// AbortController polyfill\nif (!global.AbortController) {\n  global.AbortController = require('abort-controller').AbortController\n}\n\n// BroadcastChannel polyfill (minimal implementation for testing)\nif (!global.BroadcastChannel) {\n  global.BroadcastChannel = class BroadcastChannel {\n    constructor(name) {\n      this.name = name\n    }\n    postMessage() {}\n    close() {}\n    addEventListener() {}\n    removeEventListener() {}\n  }\n}\n\n// Timer functions polyfill - essential for Auth Service activity tracking\n// Ensure timer functions are available globally before Jest setup runs\nif (typeof global.setInterval === 'undefined') {\n  global.setInterval = function(callback, delay, ...args) {\n    // Return a mock ID for testing\n    return Math.random()\n  }\n}\n\nif (typeof global.setTimeout === 'undefined') {\n  global.setTimeout = function(callback, delay, ...args) {\n    // Return a mock ID for testing\n    return Math.random()\n  }\n}\n\nif (typeof global.clearInterval === 'undefined') {\n  global.clearInterval = function(id) {\n    // No-op for testing\n  }\n}\n\nif (typeof global.clearTimeout === 'undefined') {\n  global.clearTimeout = function(id) {\n    // No-op for testing\n  }\n}"],"names":["TextEncoder","TextDecoder","require","global","URL","URLSearchParams","ReadableStream","WritableStream","TransformStream","e","console","warn","AbortController","BroadcastChannel","constructor","name","postMessage","close","addEventListener","removeEventListener","setInterval","callback","delay","args","Math","random","setTimeout","clearInterval","id","clearTimeout"],"mappings":"AAAA,kCAAkC;AAElC,+CAA+C;;AAC/C,MAAM,EAAEA,WAAW,EAAEC,WAAW,EAAE,GAAGC,QAAQ;AAC7CC,OAAOH,WAAW,GAAGA;AACrBG,OAAOF,WAAW,GAAGA;AAErB,iBAAiB;AACjBC,QAAQ;AAER,eAAe;AACf,MAAM,EAAEE,GAAG,EAAEC,eAAe,EAAE,GAAGH,QAAQ;AACzCC,OAAOC,GAAG,GAAGA;AACbD,OAAOE,eAAe,GAAGA;AAEzB,uBAAuB;AACvB,IAAI;IACF,MAAM,EAAEC,cAAc,EAAEC,cAAc,EAAEC,eAAe,EAAE,GAAGN,QAAQ;IACpE,IAAI,CAACC,OAAOG,cAAc,EAAEH,OAAOG,cAAc,GAAGA;IACpD,IAAI,CAACH,OAAOI,cAAc,EAAEJ,OAAOI,cAAc,GAAGA;IACpD,IAAI,CAACJ,OAAOK,eAAe,EAAEL,OAAOK,eAAe,GAAGA;AACxD,EAAE,OAAOC,GAAG;IACV,qEAAqE;IACrEC,QAAQC,IAAI,CAAC;IACb,IAAI,CAACR,OAAOG,cAAc,EAAE;QAC1BH,OAAOG,cAAc,GAAG,MAAMA;QAAgB;IAChD;IACA,IAAI,CAACH,OAAOK,eAAe,EAAE;QAC3BL,OAAOK,eAAe,GAAG,MAAMA;QAAiB;IAClD;AACF;AAEA,2BAA2B;AAC3B,IAAI,CAACL,OAAOS,eAAe,EAAE;IAC3BT,OAAOS,eAAe,GAAGV,QAAQ,oBAAoBU,eAAe;AACtE;AAEA,iEAAiE;AACjE,IAAI,CAACT,OAAOU,gBAAgB,EAAE;IAC5BV,OAAOU,gBAAgB,GAAG,MAAMA;QAC9BC,YAAYC,IAAI,CAAE;YAChB,IAAI,CAACA,IAAI,GAAGA;QACd;QACAC,cAAc,CAAC;QACfC,QAAQ,CAAC;QACTC,mBAAmB,CAAC;QACpBC,sBAAsB,CAAC;IACzB;AACF;AAEA,0EAA0E;AAC1E,uEAAuE;AACvE,IAAI,OAAOhB,OAAOiB,WAAW,KAAK,aAAa;IAC7CjB,OAAOiB,WAAW,GAAG,SAASC,QAAQ,EAAEC,KAAK,EAAE,GAAGC,IAAI;QACpD,+BAA+B;QAC/B,OAAOC,KAAKC,MAAM;IACpB;AACF;AAEA,IAAI,OAAOtB,OAAOuB,UAAU,KAAK,aAAa;IAC5CvB,OAAOuB,UAAU,GAAG,SAASL,QAAQ,EAAEC,KAAK,EAAE,GAAGC,IAAI;QACnD,+BAA+B;QAC/B,OAAOC,KAAKC,MAAM;IACpB;AACF;AAEA,IAAI,OAAOtB,OAAOwB,aAAa,KAAK,aAAa;IAC/CxB,OAAOwB,aAAa,GAAG,SAASC,EAAE;IAChC,oBAAoB;IACtB;AACF;AAEA,IAAI,OAAOzB,OAAO0B,YAAY,KAAK,aAAa;IAC9C1B,OAAO0B,YAAY,GAAG,SAASD,EAAE;IAC/B,oBAAoB;IACtB;AACF"}