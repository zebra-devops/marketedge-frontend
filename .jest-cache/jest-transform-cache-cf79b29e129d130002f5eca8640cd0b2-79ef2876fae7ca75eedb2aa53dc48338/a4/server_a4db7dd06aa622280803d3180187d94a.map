{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/test-utils/mocks/server.ts"],"sourcesContent":["/**\n * Mock Service Worker (MSW) Server Setup\n * \n * Provides API mocking for testing multi-tenant scenarios.\n * Handles authentication, tenant-specific data, and rate limiting responses.\n */\n\nimport { setupServer } from 'msw/node'\nimport { http, HttpResponse } from 'msw'\nimport { generateMockApiResponse, mockDataGenerators } from '../index'\n\n// Base API URL for mocking\nconst API_BASE_URL = 'http://localhost:8000/api/v1'\n\n// Mock handlers for different API endpoints\nconst handlers = [\n  // Authentication endpoints\n  http.post(`${API_BASE_URL}/auth/login`, async ({ request }) => {\n    const body = await request.json()\n    const { email, password } = body as any\n    \n    if (email === 'test@example.com' && password === 'password123') {\n      return HttpResponse.json({\n        access_token: 'mock-jwt-token',\n        token_type: 'bearer',\n        expires_in: 3600,\n        user: {\n          id: 'test-user-456',\n          email: 'test@example.com',\n          name: 'Test User',\n          role: 'user',\n          organization_id: 'test-tenant-123',\n          is_active: true,\n        },\n        organization: {\n          id: 'test-tenant-123',\n          name: 'Test Organization',\n          industry: 'b2b',\n          subscription: 'premium',\n          features: ['market-edge', 'analytics', 'reporting'],\n        },\n      }, { status: 200 })\n    }\n    \n    return HttpResponse.json(\n      { detail: 'Invalid credentials' },\n      { status: 401 }\n    )\n  }),\n\n  rest.post(`${API_BASE_URL}/auth/refresh`, (req, res, ctx) => {\n    return res(\n      ctx.status(200),\n      ctx.json({\n        access_token: 'new-mock-jwt-token',\n        token_type: 'bearer',\n        expires_in: 3600,\n      })\n    )\n  }),\n\n  rest.post(`${API_BASE_URL}/auth/logout`, (req, res, ctx) => {\n    return res(ctx.status(200), ctx.json({ message: 'Logged out successfully' }))\n  }),\n\n  // User profile endpoints\n  rest.get(`${API_BASE_URL}/users/me`, (req, res, ctx) => {\n    const authHeader = req.headers.get('authorization')\n    \n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res(ctx.status(401), ctx.json({ detail: 'Not authenticated' }))\n    }\n    \n    return res(\n      ctx.status(200),\n      ctx.json({\n        id: 'test-user-456',\n        email: 'test@example.com',\n        name: 'Test User',\n        role: 'user',\n        organization_id: 'test-tenant-123',\n        permissions: ['read:data', 'write:data'],\n        is_active: true,\n        created_at: '2024-01-01T00:00:00Z',\n        updated_at: '2024-01-01T00:00:00Z',\n      })\n    )\n  }),\n\n  // Organization endpoints\n  rest.get(`${API_BASE_URL}/organizations/me`, (req, res, ctx) => {\n    return res(\n      ctx.status(200),\n      ctx.json({\n        id: 'test-tenant-123',\n        name: 'Test Organization',\n        industry: 'b2b',\n        subscription: 'premium',\n        features: ['market-edge', 'analytics', 'reporting'],\n        limits: {\n          users: 100,\n          api_calls: 10000,\n          storage: 1000,\n        },\n        settings: {\n          timezone: 'UTC',\n          currency: 'USD',\n          date_format: 'YYYY-MM-DD',\n        },\n      })\n    )\n  }),\n\n  // Market Edge API endpoints\n  rest.get(`${API_BASE_URL}/market-edge/competitors`, (req, res, ctx) => {\n    const industry = req.url.searchParams.get('industry') || 'b2b'\n    \n    // Simulate different data based on industry\n    let mockData\n    switch (industry) {\n      case 'cinema':\n        mockData = generateMockApiResponse('cinema', 'venue', 3)\n        break\n      case 'hotel':\n        mockData = generateMockApiResponse('hotel', 'property', 3)\n        break\n      case 'gym':\n        mockData = generateMockApiResponse('gym', 'facility', 3)\n        break\n      case 'retail':\n        mockData = generateMockApiResponse('retail', 'store', 3)\n        break\n      default:\n        mockData = generateMockApiResponse('b2b', 'client', 3)\n    }\n\n    return res(\n      ctx.status(200),\n      ctx.json({\n        data: mockData,\n        meta: {\n          total: mockData.length,\n          page: 1,\n          per_page: 10,\n          industry,\n        },\n      })\n    )\n  }),\n\n  rest.get(`${API_BASE_URL}/market-edge/analytics`, (req, res, ctx) => {\n    const timeframe = req.url.searchParams.get('timeframe') || '7d'\n    \n    return res(\n      ctx.status(200),\n      ctx.json({\n        metrics: {\n          revenue: 125000,\n          growth: 12.5,\n          market_share: 15.2,\n          competitor_count: 8,\n        },\n        trends: {\n          daily_revenue: [\n            { date: '2024-01-08', value: 18000 },\n            { date: '2024-01-09', value: 19200 },\n            { date: '2024-01-10', value: 17800 },\n            { date: '2024-01-11', value: 20100 },\n            { date: '2024-01-12', value: 21500 },\n            { date: '2024-01-13', value: 19800 },\n            { date: '2024-01-14', value: 22000 },\n          ],\n        },\n        timeframe,\n      })\n    )\n  }),\n\n  // Feature flags endpoints\n  rest.get(`${API_BASE_URL}/features`, (req, res, ctx) => {\n    return res(\n      ctx.status(200),\n      ctx.json({\n        flags: {\n          'market-edge': { enabled: true, rollout: 100 },\n          'advanced-analytics': { enabled: true, rollout: 75 },\n          'real-time-data': { enabled: false, rollout: 25 },\n          'mobile-app': { enabled: true, rollout: 100 },\n        },\n      })\n    )\n  }),\n\n  // Admin endpoints (require admin role)\n  rest.get(`${API_BASE_URL}/admin/users`, (req, res, ctx) => {\n    const authHeader = req.headers.get('authorization')\n    \n    // Simulate role-based access control\n    if (!authHeader || authHeader === 'Bearer non-admin-token') {\n      return res(ctx.status(403), ctx.json({ detail: 'Insufficient permissions' }))\n    }\n    \n    return res(\n      ctx.status(200),\n      ctx.json({\n        users: [\n          {\n            id: 'user-1',\n            email: 'admin@example.com',\n            name: 'Admin User',\n            role: 'admin',\n            is_active: true,\n          },\n          {\n            id: 'user-2',\n            email: 'manager@example.com',\n            name: 'Manager User',\n            role: 'manager',\n            is_active: true,\n          },\n          {\n            id: 'user-3',\n            email: 'user@example.com',\n            name: 'Regular User',\n            role: 'user',\n            is_active: true,\n          },\n        ],\n        meta: { total: 3, page: 1, per_page: 10 },\n      })\n    )\n  }),\n\n  // Rate limiting simulation\n  rest.get(`${API_BASE_URL}/test/rate-limit`, (req, res, ctx) => {\n    // Simulate rate limit headers\n    return res(\n      ctx.status(200),\n      ctx.set('X-RateLimit-Limit', '100'),\n      ctx.set('X-RateLimit-Remaining', '95'),\n      ctx.set('X-RateLimit-Reset', String(Date.now() + 3600000)),\n      ctx.json({ message: 'Rate limit test successful' })\n    )\n  }),\n\n  rest.get(`${API_BASE_URL}/test/rate-limit-exceeded`, (req, res, ctx) => {\n    return res(\n      ctx.status(429),\n      ctx.set('X-RateLimit-Limit', '100'),\n      ctx.set('X-RateLimit-Remaining', '0'),\n      ctx.set('X-RateLimit-Reset', String(Date.now() + 3600000)),\n      ctx.set('Retry-After', '60'),\n      ctx.json({\n        error: 'Rate limit exceeded',\n        message: 'Too many requests. Limit: 100 per window',\n        retry_after: 60,\n      })\n    )\n  }),\n\n  // Error simulation endpoints for testing error handling\n  rest.get(`${API_BASE_URL}/test/server-error`, (req, res, ctx) => {\n    return res(\n      ctx.status(500),\n      ctx.json({ detail: 'Internal server error' })\n    )\n  }),\n\n  rest.get(`${API_BASE_URL}/test/network-error`, (req, res, ctx) => {\n    return res.networkError('Network error simulated')\n  }),\n\n  rest.get(`${API_BASE_URL}/test/timeout`, (req, res, ctx) => {\n    // Simulate a slow response\n    return res(\n      ctx.delay(10000), // 10 second delay\n      ctx.status(200),\n      ctx.json({ message: 'Slow response' })\n    )\n  }),\n\n  // Fallback handler for unmatched requests\n  rest.get('*', (req, res, ctx) => {\n    console.warn(`Unhandled GET request to ${req.url.toString()}`)\n    return res(\n      ctx.status(404),\n      ctx.json({ detail: `Endpoint not found: ${req.url.pathname}` })\n    )\n  }),\n\n  rest.post('*', (req, res, ctx) => {\n    console.warn(`Unhandled POST request to ${req.url.toString()}`)\n    return res(\n      ctx.status(404),\n      ctx.json({ detail: `Endpoint not found: ${req.url.pathname}` })\n    )\n  }),\n]\n\n// Create and export the server\nexport const server = setupServer(...handlers)\n\n// Helper functions for test-specific mocking\nexport const mockApiEndpoint = {\n  // Mock successful responses\n  success: (endpoint: string, data: any, status = 200) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(ctx.status(status), ctx.json(data))\n      })\n    )\n  },\n\n  // Mock error responses\n  error: (endpoint: string, status = 500, message = 'Server error') => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(ctx.status(status), ctx.json({ detail: message }))\n      })\n    )\n  },\n\n  // Mock rate limit responses\n  rateLimited: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(429),\n          ctx.set('X-RateLimit-Limit', '100'),\n          ctx.set('X-RateLimit-Remaining', '0'),\n          ctx.set('Retry-After', '60'),\n          ctx.json({\n            error: 'Rate limit exceeded',\n            message: 'Too many requests',\n            retry_after: 60,\n          })\n        )\n      })\n    )\n  },\n\n  // Mock network errors\n  networkError: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res.networkError('Network connection failed')\n      })\n    )\n  },\n\n  // Mock slow responses\n  slow: (endpoint: string, delay = 5000) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.delay(delay),\n          ctx.status(200),\n          ctx.json({ message: 'Delayed response' })\n        )\n      })\n    )\n  },\n}\n\n// Industry-specific mock helpers\nexport const mockIndustryData = {\n  cinema: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(200),\n          ctx.json({\n            venues: generateMockApiResponse('cinema', 'venue', 5),\n            movies: generateMockApiResponse('cinema', 'movie', 10),\n            bookings: generateMockApiResponse('cinema', 'booking', 20),\n          })\n        )\n      })\n    )\n  },\n\n  hotel: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(200),\n          ctx.json({\n            properties: generateMockApiResponse('hotel', 'property', 3),\n            rooms: generateMockApiResponse('hotel', 'room', 50),\n            reservations: generateMockApiResponse('hotel', 'reservation', 30),\n          })\n        )\n      })\n    )\n  },\n\n  gym: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(200),\n          ctx.json({\n            facilities: generateMockApiResponse('gym', 'facility', 2),\n            members: generateMockApiResponse('gym', 'member', 100),\n            checkins: generateMockApiResponse('gym', 'checkin', 200),\n          })\n        )\n      })\n    )\n  },\n\n  retail: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(200),\n          ctx.json({\n            stores: generateMockApiResponse('retail', 'store', 5),\n            products: generateMockApiResponse('retail', 'product', 500),\n            sales: generateMockApiResponse('retail', 'sale', 1000),\n          })\n        )\n      })\n    )\n  },\n\n  b2b: (endpoint: string) => {\n    server.use(\n      rest.get(`${API_BASE_URL}${endpoint}`, (req, res, ctx) => {\n        return res(\n          ctx.status(200),\n          ctx.json({\n            clients: generateMockApiResponse('b2b', 'client', 25),\n            projects: generateMockApiResponse('b2b', 'project', 50),\n            reports: generateMockApiResponse('b2b', 'report', 100),\n          })\n        )\n      })\n    )\n  },\n}"],"names":["mockApiEndpoint","mockIndustryData","server","API_BASE_URL","handlers","http","post","request","body","json","email","password","HttpResponse","access_token","token_type","expires_in","user","id","name","role","organization_id","is_active","organization","industry","subscription","features","status","detail","rest","req","res","ctx","message","get","authHeader","headers","startsWith","permissions","created_at","updated_at","limits","users","api_calls","storage","settings","timezone","currency","date_format","url","searchParams","mockData","generateMockApiResponse","data","meta","total","length","page","per_page","timeframe","metrics","revenue","growth","market_share","competitor_count","trends","daily_revenue","date","value","flags","enabled","rollout","set","String","Date","now","error","retry_after","networkError","delay","console","warn","toString","pathname","setupServer","success","endpoint","use","rateLimited","slow","cinema","venues","movies","bookings","hotel","properties","rooms","reservations","gym","facilities","members","checkins","retail","stores","products","sales","b2b","clients","projects","reports"],"mappings":"AAAA;;;;;CAKC;;;;;;;;;;;IA0SYA,eAAe;eAAfA;;IA8DAC,gBAAgB;eAAhBA;;IAjEAC,MAAM;eAANA;;;sBArSe;qBACO;uBACyB;AAE5D,2BAA2B;AAC3B,MAAMC,eAAe;AAErB,4CAA4C;AAC5C,MAAMC,WAAW;IACf,2BAA2B;IAC3BC,SAAI,CAACC,IAAI,CAAC,CAAC,EAAEH,aAAa,WAAW,CAAC,EAAE,OAAO,EAAEI,OAAO,EAAE;QACxD,MAAMC,OAAO,MAAMD,QAAQE,IAAI;QAC/B,MAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAE,GAAGH;QAE5B,IAAIE,UAAU,sBAAsBC,aAAa,eAAe;YAC9D,OAAOC,iBAAY,CAACH,IAAI,CAAC;gBACvBI,cAAc;gBACdC,YAAY;gBACZC,YAAY;gBACZC,MAAM;oBACJC,IAAI;oBACJP,OAAO;oBACPQ,MAAM;oBACNC,MAAM;oBACNC,iBAAiB;oBACjBC,WAAW;gBACb;gBACAC,cAAc;oBACZL,IAAI;oBACJC,MAAM;oBACNK,UAAU;oBACVC,cAAc;oBACdC,UAAU;wBAAC;wBAAe;wBAAa;qBAAY;gBACrD;YACF,GAAG;gBAAEC,QAAQ;YAAI;QACnB;QAEA,OAAOd,iBAAY,CAACH,IAAI,CACtB;YAAEkB,QAAQ;QAAsB,GAChC;YAAED,QAAQ;QAAI;IAElB;IAEAE,KAAKtB,IAAI,CAAC,CAAC,EAAEH,aAAa,aAAa,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACnD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACPI,cAAc;YACdC,YAAY;YACZC,YAAY;QACd;IAEJ;IAEAa,KAAKtB,IAAI,CAAC,CAAC,EAAEH,aAAa,YAAY,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAClD,OAAOD,IAAIC,IAAIL,MAAM,CAAC,MAAMK,IAAItB,IAAI,CAAC;YAAEuB,SAAS;QAA0B;IAC5E;IAEA,yBAAyB;IACzBJ,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,SAAS,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAC9C,MAAMG,aAAaL,IAAIM,OAAO,CAACF,GAAG,CAAC;QAEnC,IAAI,CAACC,cAAc,CAACA,WAAWE,UAAU,CAAC,YAAY;YACpD,OAAON,IAAIC,IAAIL,MAAM,CAAC,MAAMK,IAAItB,IAAI,CAAC;gBAAEkB,QAAQ;YAAoB;QACrE;QAEA,OAAOG,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACPQ,IAAI;YACJP,OAAO;YACPQ,MAAM;YACNC,MAAM;YACNC,iBAAiB;YACjBiB,aAAa;gBAAC;gBAAa;aAAa;YACxChB,WAAW;YACXiB,YAAY;YACZC,YAAY;QACd;IAEJ;IAEA,yBAAyB;IACzBX,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,iBAAiB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACtD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACPQ,IAAI;YACJC,MAAM;YACNK,UAAU;YACVC,cAAc;YACdC,UAAU;gBAAC;gBAAe;gBAAa;aAAY;YACnDe,QAAQ;gBACNC,OAAO;gBACPC,WAAW;gBACXC,SAAS;YACX;YACAC,UAAU;gBACRC,UAAU;gBACVC,UAAU;gBACVC,aAAa;YACf;QACF;IAEJ;IAEA,4BAA4B;IAC5BnB,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,wBAAwB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAC7D,MAAMR,WAAWM,IAAImB,GAAG,CAACC,YAAY,CAAChB,GAAG,CAAC,eAAe;QAEzD,4CAA4C;QAC5C,IAAIiB;QACJ,OAAQ3B;YACN,KAAK;gBACH2B,WAAWC,IAAAA,8BAAuB,EAAC,UAAU,SAAS;gBACtD;YACF,KAAK;gBACHD,WAAWC,IAAAA,8BAAuB,EAAC,SAAS,YAAY;gBACxD;YACF,KAAK;gBACHD,WAAWC,IAAAA,8BAAuB,EAAC,OAAO,YAAY;gBACtD;YACF,KAAK;gBACHD,WAAWC,IAAAA,8BAAuB,EAAC,UAAU,SAAS;gBACtD;YACF;gBACED,WAAWC,IAAAA,8BAAuB,EAAC,OAAO,UAAU;QACxD;QAEA,OAAOrB,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACP2C,MAAMF;YACNG,MAAM;gBACJC,OAAOJ,SAASK,MAAM;gBACtBC,MAAM;gBACNC,UAAU;gBACVlC;YACF;QACF;IAEJ;IAEAK,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,sBAAsB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAC3D,MAAM2B,YAAY7B,IAAImB,GAAG,CAACC,YAAY,CAAChB,GAAG,CAAC,gBAAgB;QAE3D,OAAOH,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACPkD,SAAS;gBACPC,SAAS;gBACTC,QAAQ;gBACRC,cAAc;gBACdC,kBAAkB;YACpB;YACAC,QAAQ;gBACNC,eAAe;oBACb;wBAAEC,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;oBACnC;wBAAED,MAAM;wBAAcC,OAAO;oBAAM;iBACpC;YACH;YACAT;QACF;IAEJ;IAEA,0BAA0B;IAC1B9B,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,SAAS,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAC9C,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACP2D,OAAO;gBACL,eAAe;oBAAEC,SAAS;oBAAMC,SAAS;gBAAI;gBAC7C,sBAAsB;oBAAED,SAAS;oBAAMC,SAAS;gBAAG;gBACnD,kBAAkB;oBAAED,SAAS;oBAAOC,SAAS;gBAAG;gBAChD,cAAc;oBAAED,SAAS;oBAAMC,SAAS;gBAAI;YAC9C;QACF;IAEJ;IAEA,uCAAuC;IACvC1C,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,YAAY,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACjD,MAAMG,aAAaL,IAAIM,OAAO,CAACF,GAAG,CAAC;QAEnC,qCAAqC;QACrC,IAAI,CAACC,cAAcA,eAAe,0BAA0B;YAC1D,OAAOJ,IAAIC,IAAIL,MAAM,CAAC,MAAMK,IAAItB,IAAI,CAAC;gBAAEkB,QAAQ;YAA2B;QAC5E;QAEA,OAAOG,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YACPgC,OAAO;gBACL;oBACExB,IAAI;oBACJP,OAAO;oBACPQ,MAAM;oBACNC,MAAM;oBACNE,WAAW;gBACb;gBACA;oBACEJ,IAAI;oBACJP,OAAO;oBACPQ,MAAM;oBACNC,MAAM;oBACNE,WAAW;gBACb;gBACA;oBACEJ,IAAI;oBACJP,OAAO;oBACPQ,MAAM;oBACNC,MAAM;oBACNE,WAAW;gBACb;aACD;YACDgC,MAAM;gBAAEC,OAAO;gBAAGE,MAAM;gBAAGC,UAAU;YAAG;QAC1C;IAEJ;IAEA,2BAA2B;IAC3B7B,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,gBAAgB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACrD,8BAA8B;QAC9B,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAIwC,GAAG,CAAC,qBAAqB,QAC7BxC,IAAIwC,GAAG,CAAC,yBAAyB,OACjCxC,IAAIwC,GAAG,CAAC,qBAAqBC,OAAOC,KAAKC,GAAG,KAAK,WACjD3C,IAAItB,IAAI,CAAC;YAAEuB,SAAS;QAA6B;IAErD;IAEAJ,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,yBAAyB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAC9D,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAIwC,GAAG,CAAC,qBAAqB,QAC7BxC,IAAIwC,GAAG,CAAC,yBAAyB,MACjCxC,IAAIwC,GAAG,CAAC,qBAAqBC,OAAOC,KAAKC,GAAG,KAAK,WACjD3C,IAAIwC,GAAG,CAAC,eAAe,OACvBxC,IAAItB,IAAI,CAAC;YACPkE,OAAO;YACP3C,SAAS;YACT4C,aAAa;QACf;IAEJ;IAEA,wDAAwD;IACxDhD,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,kBAAkB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACvD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YAAEkB,QAAQ;QAAwB;IAE/C;IAEAC,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,mBAAmB,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QACxD,OAAOD,IAAI+C,YAAY,CAAC;IAC1B;IAEAjD,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,aAAa,CAAC,EAAE,CAAC0B,KAAKC,KAAKC;QAClD,2BAA2B;QAC3B,OAAOD,IACLC,IAAI+C,KAAK,CAAC,QACV/C,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YAAEuB,SAAS;QAAgB;IAExC;IAEA,0CAA0C;IAC1CJ,KAAKK,GAAG,CAAC,KAAK,CAACJ,KAAKC,KAAKC;QACvBgD,QAAQC,IAAI,CAAC,CAAC,yBAAyB,EAAEnD,IAAImB,GAAG,CAACiC,QAAQ,GAAG,CAAC;QAC7D,OAAOnD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YAAEkB,QAAQ,CAAC,oBAAoB,EAAEE,IAAImB,GAAG,CAACkC,QAAQ,CAAC,CAAC;QAAC;IAEjE;IAEAtD,KAAKtB,IAAI,CAAC,KAAK,CAACuB,KAAKC,KAAKC;QACxBgD,QAAQC,IAAI,CAAC,CAAC,0BAA0B,EAAEnD,IAAImB,GAAG,CAACiC,QAAQ,GAAG,CAAC;QAC9D,OAAOnD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;YAAEkB,QAAQ,CAAC,oBAAoB,EAAEE,IAAImB,GAAG,CAACkC,QAAQ,CAAC,CAAC;QAAC;IAEjE;CACD;AAGM,MAAMhF,SAASiF,IAAAA,iBAAW,KAAI/E;AAG9B,MAAMJ,kBAAkB;IAC7B,4BAA4B;IAC5BoF,SAAS,CAACC,UAAkBjC,MAAW1B,SAAS,GAAG;QACjDxB,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IAAIC,IAAIL,MAAM,CAACA,SAASK,IAAItB,IAAI,CAAC2C;QAC1C;IAEJ;IAEA,uBAAuB;IACvBuB,OAAO,CAACU,UAAkB3D,SAAS,GAAG,EAAEM,UAAU,cAAc;QAC9D9B,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IAAIC,IAAIL,MAAM,CAACA,SAASK,IAAItB,IAAI,CAAC;gBAAEkB,QAAQK;YAAQ;QAC5D;IAEJ;IAEA,4BAA4B;IAC5BuD,aAAa,CAACF;QACZnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAIwC,GAAG,CAAC,qBAAqB,QAC7BxC,IAAIwC,GAAG,CAAC,yBAAyB,MACjCxC,IAAIwC,GAAG,CAAC,eAAe,OACvBxC,IAAItB,IAAI,CAAC;gBACPkE,OAAO;gBACP3C,SAAS;gBACT4C,aAAa;YACf;QAEJ;IAEJ;IAEA,sBAAsB;IACtBC,cAAc,CAACQ;QACbnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IAAI+C,YAAY,CAAC;QAC1B;IAEJ;IAEA,sBAAsB;IACtBW,MAAM,CAACH,UAAkBP,QAAQ,IAAI;QACnC5E,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAI+C,KAAK,CAACA,QACV/C,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBAAEuB,SAAS;YAAmB;QAE3C;IAEJ;AACF;AAGO,MAAM/B,mBAAmB;IAC9BwF,QAAQ,CAACJ;QACPnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBACPiF,QAAQvC,IAAAA,8BAAuB,EAAC,UAAU,SAAS;gBACnDwC,QAAQxC,IAAAA,8BAAuB,EAAC,UAAU,SAAS;gBACnDyC,UAAUzC,IAAAA,8BAAuB,EAAC,UAAU,WAAW;YACzD;QAEJ;IAEJ;IAEA0C,OAAO,CAACR;QACNnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBACPqF,YAAY3C,IAAAA,8BAAuB,EAAC,SAAS,YAAY;gBACzD4C,OAAO5C,IAAAA,8BAAuB,EAAC,SAAS,QAAQ;gBAChD6C,cAAc7C,IAAAA,8BAAuB,EAAC,SAAS,eAAe;YAChE;QAEJ;IAEJ;IAEA8C,KAAK,CAACZ;QACJnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBACPyF,YAAY/C,IAAAA,8BAAuB,EAAC,OAAO,YAAY;gBACvDgD,SAAShD,IAAAA,8BAAuB,EAAC,OAAO,UAAU;gBAClDiD,UAAUjD,IAAAA,8BAAuB,EAAC,OAAO,WAAW;YACtD;QAEJ;IAEJ;IAEAkD,QAAQ,CAAChB;QACPnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBACP6F,QAAQnD,IAAAA,8BAAuB,EAAC,UAAU,SAAS;gBACnDoD,UAAUpD,IAAAA,8BAAuB,EAAC,UAAU,WAAW;gBACvDqD,OAAOrD,IAAAA,8BAAuB,EAAC,UAAU,QAAQ;YACnD;QAEJ;IAEJ;IAEAsD,KAAK,CAACpB;QACJnF,OAAOoF,GAAG,CACR1D,KAAKK,GAAG,CAAC,CAAC,EAAE9B,aAAa,EAAEkF,SAAS,CAAC,EAAE,CAACxD,KAAKC,KAAKC;YAChD,OAAOD,IACLC,IAAIL,MAAM,CAAC,MACXK,IAAItB,IAAI,CAAC;gBACPiG,SAASvD,IAAAA,8BAAuB,EAAC,OAAO,UAAU;gBAClDwD,UAAUxD,IAAAA,8BAAuB,EAAC,OAAO,WAAW;gBACpDyD,SAASzD,IAAAA,8BAAuB,EAAC,OAAO,UAAU;YACpD;QAEJ;IAEJ;AACF"}