{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/ui/AccountMenu.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport {\n  UserCircleIcon,\n  Cog6ToothIcon,\n  ShieldCheckIcon,\n  ArrowRightOnRectangleIcon,\n  ChevronDownIcon\n} from '@heroicons/react/24/outline';\nimport { useAuthContext } from '@/hooks/useAuth';\nimport { User } from '@/types/auth';\n\ninterface AccountMenuProps {\n  className?: string;\n}\n\nexport const AccountMenu: React.FC<AccountMenuProps> = ({ className = '' }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { user, logout } = useAuthContext();\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleLogout = () => {\n    logout();\n    setIsOpen(false);\n  };\n\n  // Check if user has admin role\n  const isAdmin = user?.role === 'admin';\n\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <div className={`relative ${className}`} ref={menuRef}>\n      {/* Account Button */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n      >\n        <UserCircleIcon className=\"h-6 w-6\" />\n        <span className=\"hidden sm:block\">{user.email}</span>\n        <ChevronDownIcon className={`h-4 w-4 transition-transform ${isOpen ? 'rotate-180' : ''}`} />\n      </button>\n\n      {/* Dropdown Menu */}\n      {isOpen && (\n        <div className=\"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50\">\n          <div className=\"py-1\">\n            {/* User Info Header */}\n            <div className=\"px-4 py-3 border-b border-gray-100\">\n              <p className=\"text-sm font-medium text-gray-900\">{user.email}</p>\n              <p className=\"text-xs text-gray-500 capitalize\">{user.role} â€¢ {user.organisation_id || 'No Organisation'}</p>\n            </div>\n\n            {/* Settings */}\n            <button\n              onClick={() => {\n                // Navigate to settings page\n                window.location.href = '/settings';\n                setIsOpen(false);\n              }}\n              className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\"\n            >\n              <Cog6ToothIcon className=\"h-4 w-4 mr-3\" />\n              Settings\n            </button>\n\n            {/* Admin Panel (only show if user is admin) */}\n            {isAdmin && (\n              <button\n                onClick={() => {\n                  // Navigate to dashboard page\n                  window.location.href = '/dashboard';\n                  setIsOpen(false);\n                }}\n                className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\"\n              >\n                <ShieldCheckIcon className=\"h-4 w-4 mr-3\" />\n                Admin Panel\n              </button>\n            )}\n\n            {/* Divider */}\n            <div className=\"border-t border-gray-100 my-1\"></div>\n\n            {/* Logout */}\n            <button\n              onClick={handleLogout}\n              className=\"flex items-center w-full px-4 py-2 text-sm text-red-700 hover:bg-red-50 hover:text-red-900\"\n            >\n              <ArrowRightOnRectangleIcon className=\"h-4 w-4 mr-3\" />\n              Sign Out\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};"],"names":["AccountMenu","className","isOpen","setIsOpen","useState","user","logout","useAuthContext","menuRef","useRef","useEffect","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleLogout","isAdmin","role","div","ref","button","onClick","UserCircleIcon","span","email","ChevronDownIcon","p","organisation_id","window","location","href","Cog6ToothIcon","ShieldCheckIcon","ArrowRightOnRectangleIcon"],"mappings":";;;;+BAeaA;;;eAAAA;;;;+DAfsC;yBAO5C;yBACwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxB,MAAMA,cAA0C,CAAC,EAAEC,YAAY,EAAE,EAAE;IACxE,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAC;IACrC,MAAM,EAAEC,IAAI,EAAEC,MAAM,EAAE,GAAGC,IAAAA,uBAAc;IACvC,MAAMC,UAAUC,IAAAA,aAAM,EAAiB;IAEvC,mCAAmC;IACnCC,IAAAA,gBAAS,EAAC;QACR,MAAMC,qBAAqB,CAACC;YAC1B,IAAIJ,QAAQK,OAAO,IAAI,CAACL,QAAQK,OAAO,CAACC,QAAQ,CAACF,MAAMG,MAAM,GAAW;gBACtEZ,UAAU;YACZ;QACF;QAEAa,SAASC,gBAAgB,CAAC,aAAaN;QACvC,OAAO,IAAMK,SAASE,mBAAmB,CAAC,aAAaP;IACzD,GAAG,EAAE;IAEL,MAAMQ,eAAe;QACnBb;QACAH,UAAU;IACZ;IAEA,+BAA+B;IAC/B,MAAMiB,UAAUf,MAAMgB,SAAS;IAE/B,IAAI,CAAChB,MAAM;QACT,OAAO;IACT;IAEA,qBACE,sBAACiB;QAAIrB,WAAW,CAAC,SAAS,EAAEA,UAAU,CAAC;QAAEsB,KAAKf;;0BAE5C,sBAACgB;gBACCC,SAAS,IAAMtB,UAAU,CAACD;gBAC1BD,WAAU;;kCAEV,qBAACyB,uBAAc;wBAACzB,WAAU;;kCAC1B,qBAAC0B;wBAAK1B,WAAU;kCAAmBI,KAAKuB,KAAK;;kCAC7C,qBAACC,wBAAe;wBAAC5B,WAAW,CAAC,6BAA6B,EAAEC,SAAS,eAAe,GAAG,CAAC;;;;YAIzFA,wBACC,qBAACoB;gBAAIrB,WAAU;0BACb,cAAA,sBAACqB;oBAAIrB,WAAU;;sCAEb,sBAACqB;4BAAIrB,WAAU;;8CACb,qBAAC6B;oCAAE7B,WAAU;8CAAqCI,KAAKuB,KAAK;;8CAC5D,sBAACE;oCAAE7B,WAAU;;wCAAoCI,KAAKgB,IAAI;wCAAC;wCAAIhB,KAAK0B,eAAe,IAAI;;;;;sCAIzF,sBAACP;4BACCC,SAAS;gCACP,4BAA4B;gCAC5BO,OAAOC,QAAQ,CAACC,IAAI,GAAG;gCACvB/B,UAAU;4BACZ;4BACAF,WAAU;;8CAEV,qBAACkC,sBAAa;oCAAClC,WAAU;;gCAAiB;;;wBAK3CmB,yBACC,sBAACI;4BACCC,SAAS;gCACP,6BAA6B;gCAC7BO,OAAOC,QAAQ,CAACC,IAAI,GAAG;gCACvB/B,UAAU;4BACZ;4BACAF,WAAU;;8CAEV,qBAACmC,wBAAe;oCAACnC,WAAU;;gCAAiB;;;sCAMhD,qBAACqB;4BAAIrB,WAAU;;sCAGf,sBAACuB;4BACCC,SAASN;4BACTlB,WAAU;;8CAEV,qBAACoC,kCAAyB;oCAACpC,WAAU;;gCAAiB;;;;;;;;AAQpE"}