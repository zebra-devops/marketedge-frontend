{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/market-edge/CompetitorTable.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport {\n  ChevronUpIcon,\n  ChevronDownIcon,\n  EyeIcon,\n  PencilIcon,\n  GlobeAltIcon,\n  BuildingOfficeIcon\n} from '@heroicons/react/24/outline';\nimport { Competitor } from '@/types/market-edge';\n\ntype SortField = 'name' | 'business_type' | 'market_share_estimate' | 'tracking_priority' | 'last_updated';\ntype SortDirection = 'asc' | 'desc';\n\ninterface CompetitorTableProps {\n  competitors: Competitor[];\n  isLoading?: boolean;\n  onViewCompetitor?: (competitor: Competitor) => void;\n  onEditCompetitor?: (competitor: Competitor) => void;\n  className?: string;\n}\n\nexport const CompetitorTable: React.FC<CompetitorTableProps> = ({\n  competitors,\n  isLoading = false,\n  onViewCompetitor,\n  onEditCompetitor,\n  className = ''\n}) => {\n  const [sortField, setSortField] = useState<SortField>('name');\n  const [sortDirection, setSortDirection] = useState<SortDirection>('asc');\n\n  const handleSort = (field: SortField) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const sortedCompetitors = useMemo(() => {\n    return [...competitors].sort((a, b) => {\n      let aValue: any = a[sortField];\n      let bValue: any = b[sortField];\n\n      // Handle null/undefined values\n      if (aValue == null && bValue == null) return 0;\n      if (aValue == null) return sortDirection === 'asc' ? 1 : -1;\n      if (bValue == null) return sortDirection === 'asc' ? -1 : 1;\n\n      // Convert to comparable values\n      if (sortField === 'last_updated') {\n        aValue = new Date(aValue).getTime();\n        bValue = new Date(bValue).getTime();\n      } else if (typeof aValue === 'string') {\n        aValue = aValue.toLowerCase();\n        bValue = bValue.toLowerCase();\n      }\n\n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [competitors, sortField, sortDirection]);\n\n  const SortIcon: React.FC<{ field: SortField }> = ({ field }) => {\n    if (sortField !== field) {\n      return <div className=\"w-4 h-4\" />; // Placeholder\n    }\n    return sortDirection === 'asc' ? \n      <ChevronUpIcon className=\"w-4 h-4\" /> : \n      <ChevronDownIcon className=\"w-4 h-4\" />;\n  };\n\n  const getPriorityBadge = (priority: number) => {\n    const colors = {\n      1: 'bg-gray-100 text-gray-800',\n      2: 'bg-blue-100 text-blue-800',\n      3: 'bg-yellow-100 text-yellow-800',\n      4: 'bg-orange-100 text-orange-800',\n      5: 'bg-red-100 text-red-800'\n    };\n    \n    const labels = {\n      1: 'Low',\n      2: 'Below Average', \n      3: 'Average',\n      4: 'High',\n      5: 'Critical'\n    };\n\n    return (\n      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${colors[priority as keyof typeof colors] || colors[3]}`}>\n        {labels[priority as keyof typeof labels] || 'Average'}\n      </span>\n    );\n  };\n\n  const formatMarketShare = (share?: number) => {\n    if (share == null) return 'N/A';\n    return `${share.toFixed(1)}%`;\n  };\n\n  const formatLastUpdated = (date?: string) => {\n    if (!date) return 'Never';\n    const updatedDate = new Date(date);\n    const now = new Date();\n    const diffInDays = Math.floor((now.getTime() - updatedDate.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (diffInDays === 0) return 'Today';\n    if (diffInDays === 1) return 'Yesterday';\n    if (diffInDays < 7) return `${diffInDays} days ago`;\n    if (diffInDays < 30) return `${Math.floor(diffInDays / 7)} weeks ago`;\n    return updatedDate.toLocaleDateString();\n  };\n\n  if (isLoading) {\n    return (\n      <div className={`bg-white rounded-lg border border-gray-200 ${className}`}>\n        <div className=\"p-6 text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-2 text-sm text-gray-500\">Loading competitors...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (competitors.length === 0) {\n    return (\n      <div className={`bg-white rounded-lg border border-gray-200 ${className}`}>\n        <div className=\"p-6 text-center\">\n          <BuildingOfficeIcon className=\"mx-auto h-12 w-12 text-gray-400\" />\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No competitors</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Get started by adding competitors to track in this market.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`bg-white rounded-lg border border-gray-200 overflow-hidden ${className}`}>\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th\n                scope=\"col\"\n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('name')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Competitor</span>\n                  <SortIcon field=\"name\" />\n                </div>\n              </th>\n              <th\n                scope=\"col\"\n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('business_type')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Type</span>\n                  <SortIcon field=\"business_type\" />\n                </div>\n              </th>\n              <th\n                scope=\"col\"\n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('market_share_estimate')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Market Share</span>\n                  <SortIcon field=\"market_share_estimate\" />\n                </div>\n              </th>\n              <th\n                scope=\"col\"\n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('tracking_priority')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Priority</span>\n                  <SortIcon field=\"tracking_priority\" />\n                </div>\n              </th>\n              <th\n                scope=\"col\"\n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('last_updated')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Last Updated</span>\n                  <SortIcon field=\"last_updated\" />\n                </div>\n              </th>\n              <th scope=\"col\" className=\"relative px-6 py-3\">\n                <span className=\"sr-only\">Actions</span>\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {sortedCompetitors.map((competitor) => (\n              <tr key={competitor.id} className=\"hover:bg-gray-50\">\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <div className=\"flex items-center\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {competitor.name}\n                      </div>\n                      {competitor.website && (\n                        <div className=\"text-sm text-gray-500 flex items-center mt-1\">\n                          <GlobeAltIcon className=\"w-3 h-3 mr-1\" />\n                          <a\n                            href={competitor.website}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"hover:text-blue-600 truncate max-w-40\"\n                          >\n                            {competitor.website.replace(/^https?:\\/\\//, '')}\n                          </a>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span className=\"text-sm text-gray-900\">\n                    {competitor.business_type || 'Not specified'}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span className=\"text-sm font-medium text-gray-900\">\n                    {formatMarketShare(competitor.market_share_estimate)}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  {getPriorityBadge(competitor.tracking_priority)}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                  {formatLastUpdated(competitor.last_updated)}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                  <div className=\"flex items-center space-x-2\">\n                    {onViewCompetitor && (\n                      <button\n                        onClick={() => onViewCompetitor(competitor)}\n                        className=\"text-blue-600 hover:text-blue-900 p-1 rounded\"\n                        title=\"View Details\"\n                      >\n                        <EyeIcon className=\"w-4 h-4\" />\n                      </button>\n                    )}\n                    {onEditCompetitor && (\n                      <button\n                        onClick={() => onEditCompetitor(competitor)}\n                        className=\"text-gray-600 hover:text-gray-900 p-1 rounded\"\n                        title=\"Edit Competitor\"\n                      >\n                        <PencilIcon className=\"w-4 h-4\" />\n                      </button>\n                    )}\n                  </div>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};"],"names":["CompetitorTable","competitors","isLoading","onViewCompetitor","onEditCompetitor","className","sortField","setSortField","useState","sortDirection","setSortDirection","handleSort","field","sortedCompetitors","useMemo","sort","a","b","aValue","bValue","Date","getTime","toLowerCase","SortIcon","div","ChevronUpIcon","ChevronDownIcon","getPriorityBadge","priority","colors","labels","span","formatMarketShare","share","toFixed","formatLastUpdated","date","updatedDate","now","diffInDays","Math","floor","toLocaleDateString","p","length","BuildingOfficeIcon","h3","table","thead","tr","th","scope","onClick","tbody","map","competitor","td","name","website","GlobeAltIcon","href","target","rel","replace","business_type","market_share_estimate","tracking_priority","last_updated","button","title","EyeIcon","PencilIcon","id"],"mappings":"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"}