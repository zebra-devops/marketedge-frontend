{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/market-edge/MarketSelector.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ChevronDownIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { Market } from '@/types/market-edge';\nimport { marketEdgeAPI } from '@/services/market-edge-api';\n\ninterface MarketSelectorProps {\n  selectedMarket?: Market;\n  onMarketSelect: (market: Market) => void;\n  onCreateMarket?: () => void;\n  className?: string;\n}\n\nexport const MarketSelector: React.FC<MarketSelectorProps> = ({\n  selectedMarket,\n  onMarketSelect,\n  onCreateMarket,\n  className = ''\n}) => {\n  const [markets, setMarkets] = useState<Market[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadMarkets();\n  }, []);\n\n  const loadMarkets = async () => {\n    try {\n      setIsLoading(true);\n      const marketData = await marketEdgeAPI.getMarkets();\n      setMarkets(marketData);\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load markets');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const filteredMarkets = markets.filter(market =>\n    market.name.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const handleMarketSelect = (market: Market) => {\n    onMarketSelect(market);\n    setIsOpen(false);\n    setSearchQuery('');\n  };\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Selected Market Display */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"w-full flex items-center justify-between px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n        disabled={isLoading}\n      >\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-green-500 rounded-full mr-3\"></div>\n          <span className=\"text-sm font-medium text-gray-900\">\n            {selectedMarket ? selectedMarket.name : 'Select Market'}\n          </span>\n        </div>\n        <ChevronDownIcon \n          className={`w-5 h-5 text-gray-400 transition-transform ${isOpen ? 'rotate-180' : ''}`} \n        />\n      </button>\n\n      {/* Dropdown */}\n      {isOpen && (\n        <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-hidden\">\n          {/* Search Input */}\n          <div className=\"p-3 border-b border-gray-200\">\n            <input\n              type=\"text\"\n              placeholder=\"Search markets...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              autoFocus\n            />\n          </div>\n\n          {/* Markets List */}\n          <div className=\"max-h-60 overflow-y-auto\">\n            {error ? (\n              <div className=\"p-4 text-center text-red-600 text-sm\">\n                {error}\n                <button\n                  onClick={loadMarkets}\n                  className=\"block mx-auto mt-2 text-blue-600 hover:text-blue-800 underline\"\n                >\n                  Retry\n                </button>\n              </div>\n            ) : isLoading ? (\n              <div className=\"p-4 text-center text-gray-500 text-sm\">\n                Loading markets...\n              </div>\n            ) : filteredMarkets.length === 0 ? (\n              <div className=\"p-4 text-center text-gray-500 text-sm\">\n                {searchQuery ? 'No markets found' : 'No markets available'}\n              </div>\n            ) : (\n              filteredMarkets.map((market) => (\n                <button\n                  key={market.id}\n                  onClick={() => handleMarketSelect(market)}\n                  className=\"w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition-colors\"\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {market.name}\n                      </div>\n                      <div className=\"text-xs text-gray-500 mt-1\">\n                        {market.competitor_count} competitors â€¢ \n                        {market.is_active ? ' Active' : ' Inactive'}\n                      </div>\n                    </div>\n                    {selectedMarket?.id === market.id && (\n                      <div className=\"w-2 h-2 bg-blue-600 rounded-full\"></div>\n                    )}\n                  </div>\n                </button>\n              ))\n            )}\n          </div>\n\n          {/* Create New Market */}\n          {onCreateMarket && (\n            <div className=\"border-t border-gray-200\">\n              <button\n                onClick={() => {\n                  onCreateMarket();\n                  setIsOpen(false);\n                }}\n                className=\"w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition-colors flex items-center text-blue-600\"\n              >\n                <PlusIcon className=\"w-4 h-4 mr-2\" />\n                <span className=\"text-sm font-medium\">Create New Market</span>\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Overlay */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 z-40\"\n          onClick={() => setIsOpen(false)}\n        />\n      )}\n    </div>\n  );\n};"],"names":["MarketSelector","selectedMarket","onMarketSelect","onCreateMarket","className","markets","setMarkets","useState","isOpen","setIsOpen","isLoading","setIsLoading","searchQuery","setSearchQuery","error","setError","useEffect","loadMarkets","marketData","marketEdgeAPI","getMarkets","err","Error","message","filteredMarkets","filter","market","name","toLowerCase","includes","handleMarketSelect","div","button","onClick","disabled","span","ChevronDownIcon","input","type","placeholder","value","onChange","e","target","autoFocus","length","map","competitor_count","is_active","id","PlusIcon"],"mappings":"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"}